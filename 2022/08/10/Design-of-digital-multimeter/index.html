<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Design of digital multimeter | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Design of digital multimeter Design of digital multimeterIntroduction of ADC (Analogue-to-digital convector)The main difference between digital multimeter and conventional multimeter is how to show th">
<meta property="og:type" content="article">
<meta property="og:title" content="Design of digital multimeter">
<meta property="og:url" content="http://example.com/2022/08/10/Design-of-digital-multimeter/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Design of digital multimeter Design of digital multimeterIntroduction of ADC (Analogue-to-digital convector)The main difference between digital multimeter and conventional multimeter is how to show th">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYWD4U.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYWBNT.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYWsCF.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYW0EV.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfp8g.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfCvj.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfiKs.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYf92Q.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfrZt.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfsdP.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfjy9.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYfXQJ.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhkSe.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhPJO.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhiWD.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhCFK.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhMY8.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhQfS.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhnTP.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhKFf.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhBpF.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhwfU.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhDl4.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhr6J.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/10/10/xYhRk6.png">
<meta property="article:published_time" content="2022-08-10T02:08:46.000Z">
<meta property="article:modified_time" content="2022-10-10T02:51:36.343Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2022/10/10/xYWD4U.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Design-of-digital-multimeter" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/10/Design-of-digital-multimeter/" class="article-date">
  <time class="dt-published" datetime="2022-08-10T02:08:46.000Z" itemprop="datePublished">2022-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Design of digital multimeter
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Design of digital multimeter</p>
<h1 id="Design-of-digital-multimeter"><a href="#Design-of-digital-multimeter" class="headerlink" title="Design of digital multimeter"></a>Design of digital multimeter</h1><h2 id="Introduction-of-ADC-Analogue-to-digital-convector"><a href="#Introduction-of-ADC-Analogue-to-digital-convector" class="headerlink" title="Introduction of ADC (Analogue-to-digital convector)"></a>Introduction of ADC (Analogue-to-digital convector)</h2><p>The main difference between digital multimeter and conventional multimeter is how to show the magnitude of the quantity measured. For conventional multimeter, we have discussed that it uses coil in a magnetic field and depends on the deflection of needle to show the magnitude. For digital multimeter, we do not use coil instead we use a new component called ADC (Analogue-to-digital convector). Before we start designing the multimeter we need to briefly introduce how ADC works. As its name suggests, it is a component that can convert analogue data (continuous data) into digital data (discrete data). There is another component which has the opposite effect of ADC, which is called DAC (Digital-to-analogue convector). DAC is not used in this project so I do not introduce it. if you are interested about it, you can go to (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Digital-to-analog_converter">https://en.wikipedia.org/wiki/Digital-to-analog_converter</a>) for more information. Do back to ADC. There are many kinds of different ADC, including Successive Approximation ADC (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Successive-approximation_ADC">https://en.wikipedia.org/wiki/Successive-approximation_ADC</a> ), Integral ADC (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Integrating_ADC">https://en.wikipedia.org/wiki/Integrating_ADC</a> ), flash ADC (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Flash_ADC">https://en.wikipedia.org/wiki/Flash_ADC</a> ), Voltage frequency conversion ADC (<a target="_blank" rel="noopener" href="https://www.asdlib.org/onlineArticles/elabware/Scheeline_ADC/ADC_visual/voltage1.html">https://www.asdlib.org/onlineArticles/elabware/Scheeline_ADC/ADC_visual/voltage1.html</a> ), ∑- Δ Type ADC (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Delta-sigma_modulation">https://en.wikipedia.org/wiki/Delta-sigma_modulation</a> ) and Pipeline ADC (<a target="_blank" rel="noopener" href="https://www.maximintegrated.com/en/design/technical-documents/tutorials/1/1023.html">https://www.maximintegrated.com/en/design/technical-documents/tutorials/1/1023.html</a> ).<br>Here I would discuss about two kinds, one is flash ADC (Figure 43)and one is Successive Approximation ADC (Figure 44).<br>    <a target="_blank" rel="noopener" href="https://imgse.com/i/xYWD4U"><img src="https://s1.ax1x.com/2022/10/10/xYWD4U.png" alt="xYWD4U.png"></a>Figure43<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYWBNT"><img src="https://s1.ax1x.com/2022/10/10/xYWBNT.png" alt="xYWBNT.png"></a>Figure44<br>For flash ADC, there is a reference voltage which is the maximum voltage that it can measure. There are several resistors connected in series to divide reference voltage. Then, measured voltage is introduced and operation-amplifier will compare the magnitude of the measured voltage and part of the reference voltage and check which level the measured voltage reach. Then, encoder will output the magnitude of the voltage in digital form.<br>For Successive Approximation ADC, there is only one operation-amplifier. First, half of reference voltage is compared with measured voltage. If measures voltage is larger than it, compare measured voltage with ¾ reference voltage, otherwise compare it with ¼ reference voltage. Then, repeat doing. The smallest division is 1/2^n *VR (VR is reference voltage). Depending on this, encoder can output the magnitude of the voltage in digital form.<br>Both of them have advantages and disadvantages, for flash ADC, it is fast and it is easy to understand. For Successive Approximation ADC, its internal structure is complex and its processing speed is slower but it uses less electronic components (it only uses one operation-amplifier).<br>I also draw a flash ADC (Figure 45). There are 8 operation-amplifiers so the digital output consists of 3 digits. If you want more precise data, you can connect more flash ADC together (Figure 46). But take care as the number of digit increases, the number of flash ADC you need would increase exponentially. For example, to get a four-digit ADC, you need two three-digit ADC. However, to get a five-digit ADC, you need four three-digit ADC.<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYWsCF"><img src="https://s1.ax1x.com/2022/10/10/xYWsCF.png" alt="xYWsCF.png"></a>Figure45<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYW0EV"><img src="https://s1.ax1x.com/2022/10/10/xYW0EV.png" alt="xYW0EV.png"></a>Figure46</p>
<h2 id="A-general-introduction-of-what-I-want-to-do"><a href="#A-general-introduction-of-what-I-want-to-do" class="headerlink" title="A general introduction of what I want to do"></a>A general introduction of what I want to do</h2><p>ADC is a complex component so it is hard for me to use a self-designed ADC. In this stage, I would use ADC in Arduino, which has its own Successive Approximation ADC. In addition, using Arduino has many other advantages and I would mention them in my later introduction. For conventional multimeter, coil has the same function as ADC, namely convert the magnitude of the quantity into another form that we can understand. For conventional multimeter, there is a needle to show the result so in digital multimeter, we also need a component to show our result. Here, I would use a screen called ST7789 to demonstrate my result. Still, for digital multimeter I need to set several gears so some resistors are needed.</p>
<h2 id="Design-of-voltage-principle-circuit"><a href="#Design-of-voltage-principle-circuit" class="headerlink" title="Design of voltage principle circuit"></a>Design of voltage principle circuit</h2><p>Before we draw the circuit, we need to think about a question, namely can we just connect ADC to measure voltage like Figure 47.<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfp8g"><img src="https://s1.ax1x.com/2022/10/10/xYfp8g.png" alt="xYfp8g.png"></a>Figure47<br>Obviously, the answer is not. There are two reasons. First, ADC is also a very complex component, if we just connect it into the measured circuit, it would affect the voltage of the measured circuit. In addition, there are a maximum voltage that ADC can hold. For the ADC in Arduino, which we would use, the maximum voltage is 5V so the range of voltage that we can measure is very limited. Let us solve this question one by one. For the first problem, I would like to introduce a new electronic component called operational-amplifier (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Operational_amplifier">https://en.wikipedia.org/wiki/Operational_amplifier</a> ). This is a useful component and its function includes Comparing two voltage, Amplifying voltage and Separating two circuits (the functions depend on how you connect the operation-amplifier) . For this project, I would use the last two functions. For the first function, we have mentioned it in ADC. Then, we need to increase the range of voltage that we can change. With the consideration of the two factors, we draw a circuit like Figure 48.<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfCvj"><img src="https://s1.ax1x.com/2022/10/10/xYfCvj.png" alt="xYfCvj.png"></a>Figure48<br>To increase the range of voltage, I connect two resistors in series so that we only measure part of the voltage. Then, we could use algorithm to get the original voltage. Here, the ratio of resistance we is 1 to 9 so we only measure one tenth of the original voltage. With this, we can calculate to find that the maximum voltage that we can measure is 50V. To remove the effect of ADC to original circuit, I add a operation-amplifier. Why I say it can separate ADC from original circuit. Operation-amplifier has infinite impedance so no current would flow through it but, in the structure show, original voltage can be outputted so we can assume that ADC is separated from original circuit. </p>
<h2 id="Design-of-current-principle-circuit"><a href="#Design-of-current-principle-circuit" class="headerlink" title="Design of current principle circuit"></a>Design of current principle circuit</h2><p>To measure current, we have to make sure that the resistance of the multimeter is low. As a result, the voltage of the resistance might be very low so it is hard to be measured. To solve this, we need to connect an operation-amplifier in another structure (Figure 49).<br><a target="_blank" rel="noopener" href="https://imgse.com/i/xYfiKs"><img src="https://s1.ax1x.com/2022/10/10/xYfiKs.png" alt="xYfiKs.png"></a>Figure49<br>In this structure, the output voltage would be increased by 10 times so that the voltage can be more obvious. Why I still talk about voltage here, because ADC can only measure voltage so we have to use I=U/R to get current. </p>
<h2 id="Design-of-schematic"><a href="#Design-of-schematic" class="headerlink" title="Design of schematic"></a>Design of schematic</h2><p>It is hard to draw Arduino in principle circuit so I do not combine them using principle circuit, I just jump to schematic (Figure 50). But before drawing schematic, we also need to draw symbols for Arduino (Figure 51) and operation-amplifier (Figure 52). Screen does not need a symbol as it can be connected into pins.<br>  [<img src="https://s1.ax1x.com/2022/10/10/xYf92Q.png" alt="xYf92Q.png">](<a target="_blank" rel="noopener" href="https://imgse.com/i/xYf92QFigure51">https://imgse.com/i/xYf92QFigure51</a><br> <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfrZt"><img src="https://s1.ax1x.com/2022/10/10/xYfrZt.png" alt="xYfrZt.png"></a>Figure52<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfsdP"><img src="https://s1.ax1x.com/2022/10/10/xYfsdP.png" alt="xYfsdP.png"></a>Figure50<br>To avoid the mistake that I did in conventional multimeter, we still use double-pole switch here. Also, the algorithm for measuring current and voltage are different so I need a pin in Arduino to tell Arduino whether we are measuring current or voltage. If it is current, the reading of pin2 would be 1 or it would be 0. In addition, we also need a pin to change the gear of current. In previous chapter, I mentioned that using Arduino has many other advantages. Now, it appears. For operation-amplifier, it needs power supply. If we use Arduino, we can use the power in Arduino so that we do not need other devices to provide power supply and GND. The last thing I want to mention is that, when you draw symbols or footprint. Please follow the instructions of the components or you would get strange results. I still made a mistake in drawing the symbol of operation-amplifier, namely I inversed + pole and – pole, which leads to a negative output of voltage. </p>
<h2 id="Design-of-PCB"><a href="#Design-of-PCB" class="headerlink" title="Design of PCB"></a>Design of PCB</h2><p>This part is completely the same as previous ones. First, draw footprints for components like Arduino (Figure 51) and operation-amplifier (Figure 52).<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfjy9"><img src="https://s1.ax1x.com/2022/10/10/xYfjy9.png" alt="xYfjy9.png"></a>Figure51<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYfXQJ"><img src="https://s1.ax1x.com/2022/10/10/xYfXQJ.png" alt="xYfXQJ.png"></a>Figure52</p>
<p>Then, use ‘PCB from schematic’ to produce PCB, organize components and set wires (Figure 53).<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhkSe"><img src="https://s1.ax1x.com/2022/10/10/xYhkSe.png" alt="xYhkSe.png"></a>Figure53<br>With PCB graph, we can send it to PCB producers and wait for it (Figure 54).<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhPJO"><img src="https://s1.ax1x.com/2022/10/10/xYhPJO.png" alt="xYhPJO.png"></a>Figure54<br>Then, we should weld the components to PCB (Figure 55).<br>   <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhiWD"><img src="https://s1.ax1x.com/2022/10/10/xYhiWD.png" alt="xYhiWD.png"></a>Figure55</p>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><p>There are two problems when we test digital multimeter. First, we output of voltage is always negative. I have analyzed this problem when I introduce schematic. It is the reason of operation-amplifier as I draw wrong poles for it. The second problem is that the measured voltage is always shaking. This is also the problem of operation-amplifier, we do not need to connect a resistor in the positive pole of operation-amplifier or the voltage might shake. After I remove the resistor, the shaking disappears (Figure 56).<br><a target="_blank" rel="noopener" href="https://imgse.com/i/xYhCFK"><img src="https://s1.ax1x.com/2022/10/10/xYhCFK.png" alt="xYhCFK.png"></a>Figure56</p>
<h2 id="Making-a-shell"><a href="#Making-a-shell" class="headerlink" title="Making a shell"></a>Making a shell</h2><p>This stage is simple so I do not discuss too much in this stage (Figure 57,58,63,64,65).<br>   <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhMY8"><img src="https://s1.ax1x.com/2022/10/10/xYhMY8.png" alt="xYhMY8.png"></a>Figure57<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhQfS"><img src="https://s1.ax1x.com/2022/10/10/xYhQfS.png" alt="xYhQfS.png"></a>Figure58<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhnTP"><img src="https://s1.ax1x.com/2022/10/10/xYhnTP.png" alt="xYhnTP.png"></a>Figure63<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhKFf"><img src="https://s1.ax1x.com/2022/10/10/xYhKFf.png" alt="xYhKFf.png"></a>Figure64<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhBpF"><img src="https://s1.ax1x.com/2022/10/10/xYhBpF.png" alt="xYhBpF.png"></a>Figure65</p>
<h2 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h2><p>For conventional multimeter, there is no coding but for this one, we need to code for the screen. The code is a bit complex so I do not explain too carefully in this report. If you are interested about it you can read line by line. I would show my code module by module and I would briefly introduce what is the aim of this part.<br>    This is initiation of screen ST7789</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">include &lt;Arduino_GFX_Library.h&gt;</span><br><span class="line"></span><br><span class="line">#define GFX_BL DF_GFX_BL &#x2F;&#x2F; default backlight pin, you may replace DF_GFX_BL to actual backlight pin</span><br><span class="line">&#x2F;* More dev device declaration: https:&#x2F;&#x2F;github.com&#x2F;moononournation&#x2F;Arduino_GFX&#x2F;wiki&#x2F;Dev-Device-Declaration *&#x2F;</span><br><span class="line">#if defined(DISPLAY_DEV_KIT)</span><br><span class="line">Arduino_GFX *gfx &#x3D; create_default_Arduino_GFX();</span><br><span class="line">#else &#x2F;* !defined(DISPLAY_DEV_KIT) *&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;* More data bus class: https:&#x2F;&#x2F;github.com&#x2F;moononournation&#x2F;Arduino_GFX&#x2F;wiki&#x2F;Data-Bus-Class *&#x2F;</span><br><span class="line">Arduino_DataBus *bus &#x3D; create_default_Arduino_DataBus();</span><br><span class="line"></span><br><span class="line">&#x2F;* More display class: https:&#x2F;&#x2F;github.com&#x2F;moononournation&#x2F;Arduino_GFX&#x2F;wiki&#x2F;Display-Class *&#x2F;</span><br><span class="line">Arduino_GFX *gfx &#x3D; new Arduino_ST7789(bus, DF_GFX_RST, 0 &#x2F;* rotation *&#x2F;, false &#x2F;* IPS *&#x2F;);</span><br><span class="line"></span><br><span class="line">#endif &#x2F;* !defined(DISPLAY_DEV_KIT) *&#x2F;</span><br><span class="line">&#x2F;*******************************************************************************</span><br><span class="line"> * End of Arduino_GFX setting</span><br><span class="line"> ******************************************************************************&#x2F; </span><br></pre></td></tr></table></figure>
<ol start="2">
<li>This is the global variables I used <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">int cartoon  &#x3D; 0;</span><br><span class="line"> float l;</span><br><span class="line"> int vt &#x3D; 0;</span><br><span class="line"> int a1t &#x3D; 0;</span><br><span class="line"> float a1l;</span><br><span class="line"> int a2t &#x3D; 0;</span><br><span class="line"> float a2l;</span><br><span class="line"> int intervala2 &#x3D; 1000;</span><br><span class="line"> int intervala1 &#x3D; 1000;</span><br><span class="line"> int interval &#x3D; 1000;</span><br><span class="line"> boolean va;</span><br><span class="line"> float r &#x3D; 120;</span><br><span class="line"> float v &#x3D; 0;</span><br><span class="line"> boolean t1 &#x3D; true;</span><br><span class="line"> float pi &#x3D; 3.1415926;</span><br><span class="line"> int count1 &#x3D; 0;</span><br><span class="line"> int count2 &#x3D; 0;</span><br><span class="line"> int x1 &#x3D; 0;</span><br><span class="line"> int x2 &#x3D; 240;</span><br><span class="line"> int astate &#x3D; 1;</span><br><span class="line"> boolean lastva;</span><br><span class="line"> int onlyone &#x3D; 0;</span><br><span class="line"> int laststate;</span><br><span class="line"> boolean fix;</span><br><span class="line"> float a1[240];</span><br></pre></td></tr></table></figure></li>
<li>This is the basic setting of screen and Arduino<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">void setup() &#123;</span><br><span class="line">  &#x2F;&#x2F; put your setup code here, to run once:</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line">  gfx-&gt;begin();</span><br><span class="line">  gfx-&gt;fillScreen(WHITE);</span><br><span class="line">  pinMode(A0,INPUT);</span><br><span class="line">  pinMode(2,INPUT);</span><br><span class="line">  pinMode(3,INPUT);</span><br><span class="line">  startstage1();</span><br><span class="line">  startstage2();</span><br><span class="line">&#x2F;&#x2F;  analogReference(INTERNAL);</span><br></pre></td></tr></table></figure></li>
<li>This is the main part of the code, which would run repetitively. The functions or procedures involved would be shown later.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">void loop() &#123;</span><br><span class="line">  &#x2F;&#x2F; put your main code here, to run repeatedly:</span><br><span class="line">&#x2F;&#x2F;  startstage1();</span><br><span class="line">&#x2F;&#x2F;  startstage2();</span><br><span class="line">  if (cartoon &#x3D;&#x3D; 0)&#123;</span><br><span class="line">  startstage1();</span><br><span class="line">  startstage2();</span><br><span class="line">    cartoon &#x3D; 1;</span><br><span class="line">  &#125;</span><br><span class="line">  else&#123;</span><br><span class="line">&#x2F;&#x2F;  &#x2F;&#x2F; ------------------------------------------</span><br><span class="line">  gfx-&gt;drawLine(0, 40, 40, 40, BLUE);</span><br><span class="line">  gfx-&gt;drawLine(40, 0, 40, 40, BLUE);</span><br><span class="line">  gfx-&gt;drawLine(40, 40, 240, 40, BLUE);</span><br><span class="line">  gfx-&gt;drawLine(0, 150, 240, 150, BLUE);</span><br><span class="line">  firststage();</span><br><span class="line">  stateshow();</span><br><span class="line">    if (laststate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">    currentmeasure1one();</span><br><span class="line">    &#125;</span><br><span class="line">    if (laststate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">    currentmeasure1two();</span><br><span class="line">    &#125;</span><br><span class="line">    if (laststate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">    currentmeasure1three();</span><br><span class="line">    &#125;</span><br><span class="line">    if (laststate &#x3D;&#x3D; 4)&#123;</span><br><span class="line">    voltagemeasure();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    &#x2F;&#x2F;------------------------------------------</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;--------------------------------------</span><br></pre></td></tr></table></figure></li>
<li>This the initial display of current and voltage part as the initial display is a bit different from others.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">void firststage()&#123;</span><br><span class="line">  if (onlyone &#x3D;&#x3D; 0)&#123;</span><br><span class="line">    lastva &#x3D; amvolchange();</span><br><span class="line">    onlyone &#x3D; 1;</span><br><span class="line">    if (amvolchange() &#x3D;&#x3D; true)&#123;</span><br><span class="line">    laststate &#x3D; 4;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(0, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;A&quot;);</span><br><span class="line">    gfx-&gt;setCursor(0, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;V&quot;);</span><br><span class="line">    gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;50V&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">    if (currentstatechange() &#x3D;&#x3D; 2)&#123;</span><br><span class="line">      laststate &#x3D; 2;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">    gfx-&gt;setCursor(142, 10);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    if (currentstatechange() &#x3D;&#x3D; 1)&#123;</span><br><span class="line">      laststate &#x3D; 1;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    if (currentstatechange() &#x3D;&#x3D; 3)&#123;</span><br><span class="line">      laststate &#x3D; 3;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#x2F;&#x2F;      gfx-&gt;setCursor(0, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;V&quot;);</span><br><span class="line">    gfx-&gt;setCursor(0, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;A&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>This is the main display of current part and voltage part. It is also made up of several procedures.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">void stateshow()&#123;</span><br><span class="line">  if (lastva !&#x3D; amvolchange() || currentstatechange() !&#x3D; laststate)&#123;</span><br><span class="line">    Serial.println(currentstatechange());</span><br><span class="line">    Serial.println(laststate);</span><br><span class="line">    Serial.println(&quot;----------------------------------------&quot;);</span><br><span class="line">    lastva &#x3D; amvolchange();</span><br><span class="line">    if (amvolchange() &#x3D;&#x3D; true)&#123;</span><br><span class="line">      if (laststate !&#x3D; 4)&#123;</span><br><span class="line">       gfx-&gt;fillScreen(WHITE);</span><br><span class="line">       int a1[240];</span><br><span class="line">       for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">   a1[i] &#x3D; 0.0;</span><br><span class="line">    &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(0, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;A&quot;);</span><br><span class="line">    gfx-&gt;setCursor(0, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;V&quot;);</span><br><span class="line">    gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(142, 10);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 4)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10V&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;50V&quot;);</span><br><span class="line">    laststate &#x3D; 4;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">       gfx-&gt;fillScreen(WHITE);</span><br><span class="line">       int a1[240];</span><br><span class="line">       for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">   a1[i] &#x3D; 0.0;</span><br><span class="line">    &#125;</span><br><span class="line">&#x2F;&#x2F;      gfx-&gt;setCursor(0, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;V&quot;);</span><br><span class="line">    gfx-&gt;setCursor(0, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;A&quot;);</span><br><span class="line">    if (currentstatechange() &#x3D;&#x3D; 1)&#123;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(142, 10);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 4)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10V&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">    laststate &#x3D;1;</span><br><span class="line">      &#125;</span><br><span class="line">       if (currentstatechange() &#x3D;&#x3D; 2)&#123;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(142, 10);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 4)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10V&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">    gfx-&gt;setCursor(142, 10);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">    laststate&#x3D; 2;</span><br><span class="line">      &#125;</span><br><span class="line">      if (currentstatechange() &#x3D;&#x3D; 3)&#123;</span><br><span class="line">      gfx-&gt;setCursor(52, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;MAX:&quot;);</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10A&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(142, 10);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;100mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (laststate &#x3D;&#x3D; 4)&#123;</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setCursor(152, 0);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">&#x2F;&#x2F;    gfx-&gt;println(&quot;10V&quot;);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">    gfx-&gt;setCursor(152, 0);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(4,4,4);</span><br><span class="line">    gfx-&gt;println(&quot;1mA&quot;);</span><br><span class="line">    laststate&#x3D; 3;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;----------------------------------------------</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;--------------------------------------</span><br></pre></td></tr></table></figure></li>
<li>This is the starting cartoons.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">void startstage1()&#123;</span><br><span class="line">  while (count1 &lt; 48)&#123;</span><br><span class="line">      Serial.println(&quot;NO&quot;);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi+v), 120+r*sin(pi+v), 120+r*cos(-pi&#x2F;2+v), 120+r*sin(-pi&#x2F;2+v), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(-pi&#x2F;2+v), 120+r*sin(-pi&#x2F;2+v), 120+r*cos(v), 120+r*sin(v), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(v), 120+r*sin(v), 120+r*cos(pi&#x2F;2+v), 120+r*sin(pi&#x2F;2+v), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi&#x2F;2+v), 120+r*sin(pi&#x2F;2+v), 120+r*cos(pi+v), 120+r*sin(pi+v), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi+v+pi&#x2F;4), 120+r*sin(pi+v+pi&#x2F;4), 120+r*cos(-pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(-pi&#x2F;2+v+pi&#x2F;4), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(-pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(-pi&#x2F;2+v+pi&#x2F;4), 120+r*cos(v+pi&#x2F;4), 120+r*sin(v+pi&#x2F;4), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(v+pi&#x2F;4), 120+r*sin(v+pi&#x2F;4), 120+r*cos(pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(pi&#x2F;2+v+pi&#x2F;4), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(pi&#x2F;2+v+pi&#x2F;4), 120+r*cos(pi+v+pi&#x2F;4), 120+r*sin(pi+v+pi&#x2F;4), BLUE);</span><br><span class="line">  if (t1 &#x3D;&#x3D; true)&#123;</span><br><span class="line">  delay(500);</span><br><span class="line">  &#125;</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi+v), 120+r*sin(pi+v), 120+r*cos(-pi&#x2F;2+v), 120+r*sin(-pi&#x2F;2+v), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(-pi&#x2F;2+v), 120+r*sin(-pi&#x2F;2+v), 120+r*cos(v), 120+r*sin(v), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(v), 120+r*sin(v), 120+r*cos(pi&#x2F;2+v), 120+r*sin(pi&#x2F;2+v), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi&#x2F;2+v), 120+r*sin(pi&#x2F;2+v), 120+r*cos(pi+v), 120+r*sin(pi+v), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi+v+pi&#x2F;4), 120+r*sin(pi+v+pi&#x2F;4), 120+r*cos(-pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(-pi&#x2F;2+v+pi&#x2F;4), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(-pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(-pi&#x2F;2+v+pi&#x2F;4), 120+r*cos(v+pi&#x2F;4), 120+r*sin(v+pi&#x2F;4), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(v+pi&#x2F;4), 120+r*sin(v+pi&#x2F;4), 120+r*cos(pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(pi&#x2F;2+v+pi&#x2F;4), WHITE);</span><br><span class="line">  gfx-&gt;drawLine(120+r*cos(pi&#x2F;2+v+pi&#x2F;4), 120+r*sin(pi&#x2F;2+v+pi&#x2F;4), 120+r*cos(pi+v+pi&#x2F;4), 120+r*sin(pi+v+pi&#x2F;4), WHITE);</span><br><span class="line">  t1 &#x3D; false;</span><br><span class="line">  r &#x3D; r - 5;</span><br><span class="line">  v &#x3D; v + 0.3;</span><br><span class="line">  Serial.println(&quot;YES&quot;);</span><br><span class="line">  count1 &#x3D; count1 + 1;</span><br><span class="line">  Serial.println(count1);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">void startstage2()&#123;</span><br><span class="line">  if (count1 &gt;&#x3D; 48)&#123;</span><br><span class="line">  gfx-&gt;setCursor(60, 60);</span><br><span class="line">  gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">  gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">  gfx-&gt;println(&quot;ShaFeng&quot;);</span><br><span class="line">  gfx-&gt;setCursor(60, 120);</span><br><span class="line">  gfx-&gt;setTextColor(YELLOW, YELLOW);</span><br><span class="line">  gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">  gfx-&gt;println(&quot;VeriMake&quot;);</span><br><span class="line">  delay(5000);</span><br><span class="line">  gfx-&gt;setCursor(60, 60);</span><br><span class="line">  gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">  gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">  gfx-&gt;println(&quot;ShaFeng&quot;);</span><br><span class="line">  gfx-&gt;setCursor(60, 120);</span><br><span class="line">  gfx-&gt;setTextColor(WHITE, WHITE);</span><br><span class="line">  gfx-&gt;setTextSize(3,3,3);</span><br><span class="line">  gfx-&gt;println(&quot;VeriMake&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int currentstatechange() &#123;</span><br><span class="line">  int statecheck &#x3D; 0;</span><br><span class="line">  int flag;</span><br><span class="line">  flag &#x3D; digitalRead(3);</span><br><span class="line">  if (flag &#x3D;&#x3D; 1)&#123;</span><br><span class="line">    fix &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line">  if (fix &#x3D;&#x3D; false)&#123;</span><br><span class="line">  if (flag &#x3D;&#x3D; 0)&#123;</span><br><span class="line">    statecheck &#x3D; 1;</span><br><span class="line">  &#125;</span><br><span class="line">  delay(50);</span><br><span class="line">  if (flag &#x3D;&#x3D; 0)&#123;</span><br><span class="line">    statecheck &#x3D; 2;</span><br><span class="line">  &#125;</span><br><span class="line">  if (statecheck &#x3D;&#x3D; 2)&#123;</span><br><span class="line">        if (astate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">      astate &#x3D; 1;</span><br><span class="line">      fix &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">      astate &#x3D; astate + 1;</span><br><span class="line">      fix &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return astate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>This is a detection of whether you change into voltage part or current part.  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">boolean amvolchange() &#123;</span><br><span class="line">  if (digitalRead(2) &#x3D;&#x3D; 0)&#123;</span><br><span class="line">    va&#x3D; true;</span><br><span class="line">  &#125;</span><br><span class="line">  else&#123;</span><br><span class="line">    va &#x3D; false;</span><br><span class="line">  &#125;</span><br><span class="line">  return va;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;void finalcon()&#123;</span><br><span class="line">&#x2F;&#x2F;  if (amvolchange() &#x3D;&#x3D; true)&#123;</span><br><span class="line">&#x2F;&#x2F;    voltagemeasyre();</span><br><span class="line">&#x2F;&#x2F;  &#125;</span><br><span class="line">&#x2F;&#x2F;  else&#123;</span><br><span class="line">&#x2F;&#x2F;    if (astate &#x3D;&#x3D; 1)&#123;</span><br><span class="line">&#x2F;&#x2F;      currentmeasure1one();</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (astate &#x3D;&#x3D; 2)&#123;</span><br><span class="line">&#x2F;&#x2F;      currentmeasure1two();</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;    if (astate &#x3D;&#x3D; 3)&#123;</span><br><span class="line">&#x2F;&#x2F;      currentmeasure1three();</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">&#x2F;&#x2F;  &#125;</span><br><span class="line">&#x2F;&#x2F;&#125;</span><br></pre></td></tr></table></figure></li>
<li>This is the display of three gears of current part. It would be used in main part of the code.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">void currentmeasure1one()&#123;</span><br><span class="line">  float amone;</span><br><span class="line">  float c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-a1[i]&#x2F;10*110, WHITE);</span><br><span class="line">    &#125;</span><br><span class="line">  amone &#x3D; analogRead(A0);</span><br><span class="line">    c &#x3D; ((amone*(4.69&#x2F;1024.0)&#x2F;10.0)*10.0);</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 239;i++)&#123;</span><br><span class="line">    a1[i] &#x3D; a1[i+1];</span><br><span class="line">    &#125;</span><br><span class="line">  a1[239] &#x3D; c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-a1[i]&#x2F;10*110, RED);</span><br><span class="line">    &#125;</span><br><span class="line">    if (intervala1 &#x3D;&#x3D; 1000)&#123;</span><br><span class="line">      if (a1t &#x3D;&#x3D; 0)&#123;</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(c);</span><br><span class="line">    a1t &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if (a1t &#x3D;&#x3D; 1)&#123;</span><br><span class="line">    gfx-&gt;setCursor(30, 170);</span><br><span class="line">    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(a1l);</span><br><span class="line">     gfx-&gt;setCursor(30, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(c);</span><br><span class="line">    a1l &#x3D; c;</span><br><span class="line">    gfx-&gt;setCursor(200, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED,RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(&quot;A&quot;);</span><br><span class="line">    intervala1 &#x3D; 0;</span><br><span class="line">    &#x2F;&#x2F; unit : A</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    intervala1 &#x3D; intervala1 + 100;</span><br><span class="line">&#125;</span><br><span class="line">void currentmeasure1three()&#123;</span><br><span class="line">  float amthree;</span><br><span class="line">  float c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;10*110), WHITE);</span><br><span class="line">    &#125;</span><br><span class="line">    amthree &#x3D; analogRead(A0);</span><br><span class="line">  c &#x3D; ((amthree*(5.0&#x2F;1024.0)*1000));</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 239;i++)&#123;</span><br><span class="line">    a1[i] &#x3D; a1[i+1];</span><br><span class="line">    &#125;</span><br><span class="line">  a1[239] &#x3D; c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;10*110), RED);</span><br><span class="line">    &#125;</span><br><span class="line">  gfx-&gt;setCursor(80, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(c);</span><br><span class="line">    delay(500);</span><br><span class="line">    gfx-&gt;setCursor(80, 170);</span><br><span class="line">    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(c);</span><br><span class="line">    gfx-&gt;setCursor(200, 170);</span><br><span class="line">    gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(&quot;uA&quot;);</span><br><span class="line">    &#x2F;&#x2F; unit : uA</span><br><span class="line">&#125;</span><br><span class="line">void currentmeasure1two()&#123;</span><br><span class="line">  float amtwo;</span><br><span class="line">  float c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;100*110), WHITE);</span><br><span class="line">    &#125;</span><br><span class="line">    amtwo &#x3D; analogRead(A0);</span><br><span class="line">  c &#x3D; ((amtwo*(5.0&#x2F;1024.0)*100));</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 239;i++)&#123;</span><br><span class="line">    a1[i] &#x3D; a1[i+1];</span><br><span class="line">    &#125;</span><br><span class="line">  a1[239] &#x3D; c;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;100*110), RED);</span><br><span class="line">    &#125;</span><br><span class="line">    if (intervala2 &#x3D;&#x3D; 1000)&#123;</span><br><span class="line">      if (a2t &#x3D;&#x3D; 0)&#123;</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(c);</span><br><span class="line">  a2t &#x3D; 1;</span><br><span class="line">      &#125;</span><br><span class="line">      if (a2t &#x3D;&#x3D; 1)&#123;</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(a2l);</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(RED,RED);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(c);</span><br><span class="line">  a2l &#x3D; c;</span><br><span class="line">  gfx-&gt;setCursor(160, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED,RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(&quot;mA&quot;);</span><br><span class="line">    intervala2 &#x3D; 0;&#125;&#125;</span><br><span class="line">    intervala2 &#x3D; intervala2 + 100;</span><br><span class="line"> &#x2F;&#x2F; unit : mA</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>This is the display of voltage, it is used in main part. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">void voltagemeasure()&#123;</span><br><span class="line">  float c;</span><br><span class="line">  int volt;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;50*110), WHITE);</span><br><span class="line">    &#125;</span><br><span class="line">  volt &#x3D; analogRead(A0);</span><br><span class="line">  c &#x3D; volt*(4.69&#x2F;1024.0)*10.01;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 239;i++)&#123;</span><br><span class="line">    a1[i] &#x3D; a1[i+1];</span><br><span class="line">    &#125;</span><br><span class="line">  a1[239] &#x3D; c;</span><br><span class="line">&#x2F;&#x2F;  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">&#x2F;&#x2F;    Serial.println(c4[i]);</span><br><span class="line">&#x2F;&#x2F;    &#125;</span><br><span class="line">  for (int i &#x3D; 0;i &lt; 240;i++)&#123;</span><br><span class="line">    gfx-&gt;drawPixel(i+1,150-int(a1[i]&#x2F;50*110), RED);</span><br><span class="line">    &#125;</span><br><span class="line">    if (interval &#x3D;&#x3D; 1000)&#123;</span><br><span class="line">      if(vt &#x3D;&#x3D; 0)&#123;</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(c);</span><br><span class="line">  vt &#x3D; 1;&#125;</span><br><span class="line">  if (vt &#x3D;&#x3D; 1)&#123;</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(WHITE,WHITE);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(l);</span><br><span class="line">  gfx-&gt;setCursor(30, 170);</span><br><span class="line">  gfx-&gt;setTextColor(RED, RED);</span><br><span class="line">  gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">  gfx-&gt;println(c);</span><br><span class="line">  l &#x3D; c;</span><br><span class="line">  gfx-&gt;setCursor(200, 170);</span><br><span class="line">    gfx-&gt;setTextColor(RED,RED);</span><br><span class="line">    gfx-&gt;setTextSize(5,5,5);</span><br><span class="line">    gfx-&gt;println(&quot;V&quot;);</span><br><span class="line">    interval &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    interval &#x3D; interval + 100;</span><br><span class="line">  &#x2F;&#x2F; unit : V</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>Last, I would show the display of the screen. I set several starting cartoons for the digital multimeter (Figure 59,60).<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhwfU"><img src="https://s1.ax1x.com/2022/10/10/xYhwfU.png" alt="xYhwfU.png"></a>Figure59<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhDl4"><img src="https://s1.ax1x.com/2022/10/10/xYhDl4.png" alt="xYhDl4.png"></a>Figure60<br>Figure 61 is the measuring of voltage and Figure 62 is for current.<br> <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhr6J"><img src="https://s1.ax1x.com/2022/10/10/xYhr6J.png" alt="xYhr6J.png"></a>Figure61<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/xYhRk6"><img src="https://s1.ax1x.com/2022/10/10/xYhRk6.png" alt="xYhRk6.png"></a>Figure62<br>The top of left tells you it is current gear or voltage gear. Near it, the ‘MAX’ tells you what the maximum range of the gear. The middle part is a wave graph of the quantity. And the bottom is the value get. </p>
<h2 id="Further-plan"><a href="#Further-plan" class="headerlink" title="Further plan"></a>Further plan</h2><p>The main task is reached in this project. Both analogue multimeter and digital multimeter can measure voltage and current. And we also succeed in setting different dears for both quantity. However, because of the precision of the components we used so there is percentage error, especially for those quantities which use small resistance, such as current. For quantities like voltage, this is not a great problem as the resistance used is very larger so small percentage difference will not have an obvious effect on the output. In addition, the output of current is still shaking so we need other method to smooth the current wave. There is an interesting phenomenon, namely even I do not connect circuit to multimeter there is still readings, though the readings are very small so we need an algorithm to filter the extra voltage.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>I learnt a lot in this project. I studied the basic principle of how amperemeter and voltmeter work and, in the designing of conventional multimeter, I could apply the knowledge that I learnt in my test book into real-life application (Such as the knowledge about electricity and magnetism).  Also, I learnt how to use Multisim to draw principle circuit and how to use KiCad to draw schematic and PCB, as well as symbols and footprints. Before the designing of digital multimeter, through research, I also generally studied how ADC and operation-amplifier work. In the designing of screen, I did a lot of coding so my coding ability is also improved a lot. In short, the whole project is electronic and practical so my understanding about electronic engineering increases a lot. The most important point I learnt is that electronic engineering is a subject to use electronic devices to solve real-life problems. From the problems I met, I learnt that making mistake is not terrible, the more important is that we need to analysis problem and think about how to solve it. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/08/10/Design-of-digital-multimeter/" data-id="cl926hd3o0000k4w3b4sa0whg" data-title="Design of digital multimeter" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/08/10/The-design-of-analog-amperemeter-and-voltmeter/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">The design of analog amperemeter and voltmeter</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/10/Design-of-digital-multimeter/">Design of digital multimeter</a>
          </li>
        
          <li>
            <a href="/2022/08/10/The-design-of-analog-amperemeter-and-voltmeter/">The design of analog amperemeter and voltmeter</a>
          </li>
        
          <li>
            <a href="/2022/07/10/Using-Python-to-simulate-projection/">Using Python to simulate projection</a>
          </li>
        
          <li>
            <a href="/2022/06/10/A-timer-combining-hardware-with-software/">A timer -- combining hardware with software</a>
          </li>
        
          <li>
            <a href="/2022/06/10/Using-Python-to-design-a-game-2/">Using Python to design a game - 2</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>